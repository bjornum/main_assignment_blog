{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}
<a href="{{ url_for('main.create_post') }}">+ Create New Post</a>
<form
  id="searchForm"
  style="margin-bottom: 1.5rem; display: flex; justify-content: center"
>
  <input
    type="text"
    id="searchInput"
    placeholder="Search posts..."
    style="
      padding: 8px 12px;
      width: 300px;
      max-width: 100%;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.05);
    "
  />
</form>

<h2>All Blog Posts</h2>

{% for post in posts %}
<article class="post" data-title="{{ post['title']|lower }}">
  <h3>{{ post['title'] }}</h3>
  <small>Published: {{ post['pub_date'] }}</small>
  <p>{{ post['content'][:150] }}...</p>

  {% if post['tags'] %}
  <p>
    Tags: {% for tag in post['tags'].split(',') %}
    <a href="{{ url_for('main.tag_page', tag_name=tag|trim) }}">{{ tag }}</a>
    {% endfor %}
  </p>
  {% endif %}

  <a href="{{ url_for('main.post_detail', post_id=post['id']) }}">Read more</a>
</article>
{% else %}
<p>No blog posts yet.</p>
{% endfor %}

<script>
  const searchInput = document.getElementById("searchInput");
  const posts = document.querySelectorAll(".post");

  searchInput.addEventListener("input", function () {
    const query = this.value.toLowerCase();

    posts.forEach((post) => {
      const title = post.dataset.title;
      if (title.includes(query)) {
        post.style.display = "";
      } else {
        post.style.display = "none";
      }
    });
  });
</script>
{% endblock %}
